# 服务注册与发现

顾名思义，分布式系统中服务注册与发现主要解决的就是两个问题：

- 服务注册：服务实例将自身服务信息注册到注册中心。这部分服务信息包括服务所在主机 IP 和提供服务的  Port，以及暴露服务自身状态以及访问协议等信息。
- 服务发现：服务实例请求注册中心获取所依赖服务信息。服务实例通过注册中心，获取到注册到其中的服务实例的信息，通过这些信息去请求它们提供的服务。

实际调用过程中，服务消费者 通过注册中心发现 服务提供者 注册的服务通讯地址和端口，然后实现 RPC(远程过程调用)。

# CAP

CAP 原则，指的是在一个分布式系统中，`Consistency`(一致性)、`Availability`(可用性)、`Partition Tolerance`(分区容错性)，不能同时成立。

- 一致性：它要求在同一时刻点，分布式系统中的所有数据备份都处于同一状态。
- 可用性：在系统集群的一部分节点宕机后，系统依然能够响应用户的请求。
- 分区容错性：在网络区间通信出现失败，系统能够容忍。

> 一般来讲，基于网络的不稳定性，分布容错是不可避免的，所以我们默认 CAP 中的 P 总是成立的。
>
> 一致性的强制数据统一要求，必然会导致在更新数据时部分节点处于被锁定状态，此时不可对外提供服务，影响了服务的可用性，反之亦然。因此一致性和可用性不能同时满足。
>
> Eureka 满足了其中的 AP(高可用性)，Consul 和 Zookeeper 满足了其中的 CP(一致性)。

Eureka

默认开启自我保护模式，即在服务暂时无法通过心跳连接时，Eureka 也不会立即从注册中心删除该服务。

Zookeeper

Consul

[官网介绍](https://www.consul.io/intro)

三者总结：